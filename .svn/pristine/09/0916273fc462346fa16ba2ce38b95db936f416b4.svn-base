using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows.Forms;

namespace ObligatorioIS2
{
    public partial class BuscarProducto : Form
    {
        public BuscarProducto()
        {
            InitializeComponent();
            CargarLista();
            CargarListbox();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            Hide();
            var venMenuPpal = new MenuPpal();
            venMenuPpal.Show();
        }

        private void textBox1_TextChanged(object sender, EventArgs e)
        {
            if (!string.IsNullOrEmpty(textBox1.Text.Trim()))
            {
                listBox1.Items.Clear();
                foreach (var str in Sistema.GetInstance()
                    .ListaProductos.Select(p => p.ToString())
                    .Where(str => str.StartsWith(textBox1.Text.Trim())))
                {
                    listBox1.Items.Add(str);
                }
            }
            else
            {
                listBox1.Items.Clear();
                CargarListbox();
            }
        }

        private void CargarListbox()
        {
            listBox1.Items.AddRange(Sistema.GetInstance()
                .ListaProductos.Cast<object>().ToArray());
        }

        private static void CargarLista()
        {
            Sistema.GetInstance().ListaProductos = new List<Producto>
            {
                new Producto {Nombre = "Microondas", Precio = "$4500"},
                new Producto {Nombre = "Aspiradora", Precio = "$2300"},
                new Producto {Nombre = "Heladera", Precio = "$10800"},
                new Producto {Nombre = "Lavarropas", Precio = "6700"},
                new Producto {Nombre = "Licuadora", Precio = "800"},
                new Producto {Nombre = "Horno", Precio = "$5500"},
                new Producto {Nombre = "Cafetera", Precio = "$1000"},
                new Producto {Nombre = "Secarropa", Precio = "$5700"},
                new Producto {Nombre = "Television LED 32'", Precio = "6700"},
                new Producto {Nombre = "Aire acondicionado 9000 BTU", Precio = "800"}
            }.OrderBy(p => p.Nombre).ToList();
        }
    }
}
